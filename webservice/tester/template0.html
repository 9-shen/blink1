
<!DOCTYPE html>
<html>
  <head>
    <title>blink(1) ifttt fake event generator </title>
    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen">

  </head>
  <body>
     <div class="container">

    <h2>blink(1) ifttt fake event generator</h2>

<p>

Use this to generate fake events as if they come from IFTTT.

</p>

<form class="form-horizontal" name="foobar" id="foobar"> 

  <div class="control-group">
    <label class="control-label">blink1_id</label>
    <div class="controls">
      <input class="" type="text" id="blink1_id" name="blink1_id" placeholder="ABCD12341234ABCD" value="{{blink1_id}}">   
      <span class="help-block">blink1_id is required. source and name are optional.</span>
    </div>
  </div>

  <div class="control-group">
    <label class="control-label">IFTTT source</label>
    <div class="controls">
      <input type="text" id="source" name="source" placeholder="gmail" value="{{source}}"> 
    </div>
  </div>

  <div class="control-group">
    <label class="control-label">IFTTT name</label>
    <div class="controls">
      <input type="text" id="name" name="name" placeholder="my favorite" value="{{name}}"> 
    </div>
  </div>

  <div class="control-group">
    <div class="controls">
      <button class="btn" id="generate-query">Generate Query URL</button>
      <button class="btn" id="send-event">Send Event</button>
    </div>
  </div>
</form>

  <div> 
  Query URL:
  <pre id="query-display">
  </pre>
  </div>

  <div> 
  Response:
  <pre id="response-display">

  </pre>
  </div>


  </div>


    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>

    <script>

    var display_query_url_base = "http://api.thingm.com/blink1/sendevent/";
    var query_url_base         = "../sendevent/";
      
    //
    function generate_query_url(url_base, blink1_id, source, name ) {
      var url = url_base + blink1_id + "?source=" + encodeURIComponent( source ) +
                                         "&name=" + encodeURIComponent( name );
      return url;
    }

    //
    $(function() {

      // disable the form submission
      $("#foobar").submit(function () { return false; });
      
      $('#generate-query').live('click', function(e) {
        var blink1_id = $('#blink1_id').val();
        var source    = $('#source').val();
        var name      = $('#name').val();

        $('#response-display').text('');

        //if( blink1_id ) { 
          var display_query_url = generate_query_url( display_query_url_base, blink1_id, source, name );
          $('#query-display').text( display_query_url );
        //}
        
      });
      
      $('#send-event').live('click', function(e) {
        var blink1_id = $('#blink1_id').val();
        var source    = $('#source').val();
        var name      = $('#name').val();
        
        var query_url = generate_query_url( query_url_base, blink1_id, source, name );

        var display_query_url = generate_query_url( display_query_url_base, blink1_id, source, name );
        $('#query-display').text( display_query_url );

        $.getJSON( query_url, null, function(result) { 
          console.log("result:");
          console.log(result);

          $('#response-display').text( JSON.stringify( result, null, '  ' )  );

        });

      });
      
    });

    </script>

  </body>
</html>



